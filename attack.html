<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µê²© ê³µëµ - ê·€ìš”ë¯¸ ê¸¸ë“œ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Noto Sans KR', -apple-system, sans-serif;
            background: linear-gradient(135deg, #6B4966 0%, #8B5A86 50%, #B08AB0 100%);
            min-height: 100vh; padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header {
            text-align: center; color: white; margin-bottom: 40px;
            background: rgba(255,255,255,0.1); backdrop-filter: blur(10px);
            padding: 30px; border-radius: 20px;
        }
        header h1 { font-size: 2.5em; margin-bottom: 10px; text-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        .nav-tabs { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; flex-wrap: wrap; }
        .nav-tab {
            padding: 10px 20px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px);
            border: none; border-radius: 10px; color: white; font-weight: bold;
            text-decoration: none; transition: all 0.3s;
        }
        .nav-tab:hover { background: rgba(255,255,255,0.3); }
        .tabs { display: flex; gap: 15px; margin-bottom: 30px; background: rgba(255,255,255,0.2); padding: 10px; border-radius: 15px; }
        .tab-btn {
            flex: 1; padding: 15px; background: transparent; border: none; color: white;
            font-size: 1.1em; font-weight: bold; cursor: pointer; border-radius: 10px; transition: all 0.3s;
        }
        .tab-btn:hover { background: rgba(255,255,255,0.2); }
        .tab-btn.active { background: linear-gradient(135deg, #FFB6C1, #FFC0CB); color: #6B4966; box-shadow: 0 4px 12px rgba(255,182,193,0.4); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .form-container { background: white; border-radius: 20px; padding: 40px; box-shadow: 0 8px 30px rgba(0,0,0,0.2); }
        .section { margin-bottom: 35px; }
        .section-title {
            font-size: 1.4em; font-weight: bold; margin-bottom: 20px;
            color: #6B4966; padding-bottom: 10px; border-bottom: 3px solid #B08AB0;
        }
        .defense-section { background: rgba(255,182,193,0.15); padding: 25px; border-radius: 15px; border: 2px solid #FFB6C1; margin-bottom: 30px; }
        .attack-section { background: rgba(152,216,200,0.1); padding: 25px; border-radius: 15px; border: 2px solid #98D8C8; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #555; font-size: 1em; }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px;
            font-size: 1em; transition: all 0.3s; font-family: inherit;
            background: white;
        }
        .form-group select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 35px;
        }
        .form-group select:disabled {
            background-color: #f5f5f5;
            cursor: not-allowed;
            color: #999;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none; border-color: #98D8C8; box-shadow: 0 0 0 3px rgba(152,216,200,0.1);
        }
        .hero-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .hero-select-group { display: flex; flex-direction: column; gap: 8px; }
        .hero-select-group label { font-size: 0.95em; color: #666; font-weight: 600; }
        .hero-select-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            font-size: 1em;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 35px;
        }
        .hero-select-group select:disabled {
            background-color: #f5f5f5;
            cursor: not-allowed;
            color: #999;
        }
        .hero-select-group select:focus {
            outline: none;
            border-color: #98D8C8;
            box-shadow: 0 0 0 3px rgba(152,216,200,0.1);
        }
        .equipment-title {
            font-size: 1.2em; font-weight: 600; color: #333; margin: 25px 0 15px 0; padding: 12px;
            background: rgba(152,216,200,0.2); border-radius: 10px; border-left: 4px solid #98D8C8;
            display: flex; align-items: center; justify-content: space-between;
        }
        .equipment-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .equipment-item { background: #f8f8f8; padding: 15px; border-radius: 10px; border: 2px solid #e0e0e0; }
        .equipment-item-title { font-weight: 600; color: #666; margin-bottom: 12px; font-size: 0.95em; }
        .equipment-options { display: flex; flex-direction: column; gap: 10px; }
        .equipment-options select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 0.95em;
        }
        .equipment-options select:focus {
            outline: none;
            border-color: #98D8C8;
        }
        .hero-equipment-layout { display: grid; grid-template-columns: 300px 1fr; gap: 25px; margin-bottom: 25px; }
        .image-preview-container { display: grid; grid-template-columns: 1fr; gap: 10px; }
        .image-preview-item {
            position: relative; height: 200px; border-radius: 10px; overflow: hidden;
            border: 2px dashed #e0e0e0; background: #f9f9f9;
            display: flex; align-items: center; justify-content: center;
            color: #999; font-size: 0.9em;
        }
        .image-preview-item img { width: 100%; height: 100%; object-fit: cover; }
        .image-remove-btn {
            position: absolute; top: 5px; right: 5px; background: rgba(255,59,48,0.9);
            color: white; border: none; border-radius: 50%; width: 30px; height: 30px;
            cursor: pointer; font-weight: bold; font-size: 1.2em; display: flex;
            align-items: center; justify-content: center;
        }
        .upload-btn-inline { display: inline-flex; position: relative; overflow: hidden; margin-left: 15px; }
        .upload-btn-inline input[type=file] { position: absolute; left: 0; top: 0; opacity: 0; cursor: pointer; width: 100%; height: 100%; }
        .upload-btn {
            padding: 8px 20px; font-size: 0.85em; display: inline-flex;
            border: 2px dashed #B08AB0; background: white; color: #6B4966;
            border-radius: 8px; cursor: pointer; align-items: center; gap: 6px; font-weight: bold;
        }
        .skill-order-section { background: rgba(255,253,208,0.7); padding: 20px; border-radius: 12px; margin-top: 25px; border: 2px solid #ffd93d; }
        .skill-order-section h4 { margin: 0 0 10px 0; color: #666; font-size: 1.1em; }
        .skill-order-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .skill-order-grid select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            font-size: 1em;
        }
        .skill-order-grid select:focus {
            outline: none;
            border-color: #ffd93d;
        }
        .btn {
            width: 100%; padding: 18px; background: linear-gradient(135deg, #98D8C8, #6FC3A8);
            color: white; border: none; border-radius: 12px; font-size: 1.2em;
            font-weight: bold; cursor: pointer; transition: all 0.3s; margin-top: 30px;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(152,216,200,0.4); }
        .search-box { background: white; border-radius: 15px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .search-box input { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em; }
        .strategy-list { display: grid; gap: 20px; }
                .strategy-card { 
            background: white; 
            border-radius: 15px; 
            padding: 30px;  /* 25pxì—ì„œ 30pxë¡œ ë³€ê²½ */
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
        }
        .strategy-header {
            display: flex; justify-content: space-between; align-items: start;
            margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #f0f0f0;
        }
        .strategy-title { 
            font-size: 1.5em;  /* 1.3emì—ì„œ 1.5emìœ¼ë¡œ ë³€ê²½ */
            font-weight: bold; 
            color: #6B4966; 
        }
        .strategy-actions { display: flex; gap: 10px; }
        .btn-delete { padding: 8px 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.9em; background: #ff3b30; color: white; }
        .btn-edit { padding: 8px 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.9em; background: #98D8C8; color: white; margin-right: 5px; }
        .btn-edit:hover { background: #7bc4b4; }
        .btn-delete:hover { background: #e6342a; }
        .hero-info { display: flex; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; }
                .hero-badge { 
            padding: 10px 18px;  /* 8px 15pxì—ì„œ 10px 18pxë¡œ ë³€ê²½ */
            background: #f0f0f0; 
            border-radius: 8px; 
            font-weight: 600; 
            color: #555; 
            font-size: 1em;  /* ì¶”ê°€ */
        }
        .hero-images { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
        .hero-images img { width: 150px; height: 150px; object-fit: cover; border-radius: 10px; border: 2px solid #e0e0e0; }
        @media (max-width: 768px) {
            .hero-grid { grid-template-columns: 1fr; }
            .equipment-grid { grid-template-columns: 1fr; }
            .skill-order-grid { grid-template-columns: 1fr; }
            .hero-equipment-layout { grid-template-columns: 1fr !important; }
            .form-container { padding: 25px; }
        }
        /* ì´ë¯¸ì§€ ëª¨ë‹¬ - ì—¬ê¸°ë¶€í„° ì¶”ê°€! */
        .image-modal { 
            display: none; position: fixed; z-index: 9999; left: 0; top: 0; 
            width: 100%; height: 100%; background: rgba(0,0,0,0.9); 
        }
        .image-modal.active { display: flex; align-items: center; justify-content: center; }
        .image-modal img { max-width: 90%; max-height: 90%; object-fit: contain; border-radius: 10px; }
        .image-modal-close { 
            position: absolute; top: 20px; right: 40px; color: white; 
            font-size: 40px; font-weight: bold; cursor: pointer; 
        }
        .image-modal-close:hover { color: #ccc; }
        
        /* ëŒ“ê¸€ ìŠ¤íƒ€ì¼ */
        .comments-section { 
            margin-top: 20px; padding-top: 20px; 
            border-top: 2px solid #f0f0f0; 
        }
        .comment-form { 
            display: flex; gap: 10px; margin-bottom: 20px; 
        }
        .comment-input { 
            flex: 1; padding: 12px; border: 2px solid #e0e0e0; 
            border-radius: 10px; font-size: 1em; 
        }
        .comment-btn { 
            padding: 12px 20px; background: #98D8C8; color: white; 
            border: none; border-radius: 10px; cursor: pointer; 
            font-weight: bold; 
        }
        .comment-btn:hover { background: #7bc4b4; }
        .comment-list { display: flex; flex-direction: column; gap: 10px; }
        .comment-item { 
            background: #f9f9f9; padding: 15px; border-radius: 10px; 
            border-left: 4px solid #98D8C8; 
        }
        .comment-header { 
            display: flex; justify-content: space-between; 
            margin-bottom: 8px; font-size: 0.9em; 
        }
        .comment-author { font-weight: bold; color: #6B4966; }
        .comment-date { color: #999; }
        .comment-text { color: #666; line-height: 1.5; }
        .comment-delete { 
            color: #ff3b30; cursor: pointer; font-size: 0.85em; 
            margin-left: 10px; 
        }
        .comment-delete:hover { text-decoration: underline; }
        
        /* 2ì—´ ë ˆì´ì•„ì›ƒ (ì‚¬ì§„ ìˆì„ ë•Œ) */
.hero-detail-layout { 
    display: grid; 
    grid-template-columns: 300px 1fr;  /* 200px â†’ 300px */
    gap: 20px;  /* 15px â†’ 20px (ê°„ê²©ë„ ì¦ê°€) */
    align-items: start; 
}
        .hero-detail-images { 
            display: flex; flex-direction: column; gap: 10px; 
        }
        .hero-detail-images img { 
            width: 100%; height: auto; border-radius: 10px; 
            border: 2px solid #e0e0e0; cursor: pointer; 
        }
        .hero-detail-images img:hover { 
            transform: scale(1.02); 
            transition: transform 0.2s; 
        }
        .hero-detail-info { display: flex; flex-direction: column; gap: 8px; }
        
        @media (max-width: 768px) {
            .hero-detail-layout { grid-template-columns: 1fr; }
        }

    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>âš”ï¸ ê³µê²© ê³µëµ ê´€ë¦¬</h1>
            <p>ìƒëŒ€ ë°©ì–´íŒ€ì„ ëŒíŒŒí•˜ëŠ” ì „ëµì„ ê³µìœ í•˜ì„¸ìš” (1:1 ë§¤ì¹­)</p>
            <div class="nav-tabs">
                <a href="main.html" class="nav-tab">ğŸ“Š ë©”ì¸</a>
                <a href="attack.html" class="nav-tab" style="background: rgba(255,255,255,0.3);">âš”ï¸ ê³µê²©</a>
                <a href="defense.html" class="nav-tab">ğŸ›¡ï¸ ë°©ì–´</a>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('register')">ê³µëµ ë“±ë¡</button>
            <button class="tab-btn" onclick="switchTab('list')">ê³µëµ ëª©ë¡ (<span id="strategyCount">0</span>)</button>
        </div>

        <!-- ê³µëµ ë“±ë¡ íƒ­ -->
        <div id="register-tab" class="tab-content active">
            <div class="form-container">
                <h2 style="margin-bottom: 10px; color: #B08AB0;">âš”ï¸ ê³µê²© ê³µëµ ë“±ë¡</h2>
                <p style="color: #999; margin-bottom: 30px;">1:1 ë§¤ì¹­ ë°©ì‹ - ë°©ì–´íŒ€ê³¼ ê³µê²©íŒ€ì„ í•œ ë²ˆì— ë“±ë¡í•©ë‹ˆë‹¤</p>
                
                <form id="strategyForm" onsubmit="saveStrategy(event)">
                    <div class="section">
                        <div class="form-group">
                            <label>ğŸ“ ê³µëµ ì´ë¦„</label>
                            <input type="text" id="strategyName" placeholder="ì˜ˆ: ë£¨ë‚˜ + ì¹´êµ¬ë¼ + ì¹´ë¥¼ë¡œ ê³µëµë²•" required>
                        </div>
                    </div>

                    <div class="defense-section">
                        <div class="section-title">ğŸ›¡ï¸ ìƒëŒ€ ë°©ì–´íŒ€ (3ëª…)</div>
                        <div class="hero-grid">
                            <div class="hero-select-group">
                                <label>ë°©ì–´ ìœ ë‹› 1</label>
                                <select onchange="updateDefenseHero(1, this.value)" required>
                                    <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                    <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                    <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                    <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                    <option value="í¬ê·€">í¬ê·€</option>
                                </select>
                                <select id="defenseHero1" required disabled>
                                    <option value="">ì˜ì›… ì„ íƒ</option>
                                </select>
                            </div>
                            <div class="hero-select-group">
                                <label>ë°©ì–´ ìœ ë‹› 2</label>
                                <select onchange="updateDefenseHero(2, this.value)" required>
                                    <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                    <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                    <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                    <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                    <option value="í¬ê·€">í¬ê·€</option>
                                </select>
                                <select id="defenseHero2" required disabled>
                                    <option value="">ì˜ì›… ì„ íƒ</option>
                                </select>
                            </div>
                            <div class="hero-select-group">
                                <label>ë°©ì–´ ìœ ë‹› 3</label>
                                <select onchange="updateDefenseHero(3, this.value)" required>
                                    <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                    <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                    <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                    <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                    <option value="í¬ê·€">í¬ê·€</option>
                                </select>
                                <select id="defenseHero3" required disabled>
                                    <option value="">ì˜ì›… ì„ íƒ</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="attack-section">
                        <div class="section-title">âš”ï¸ ê³µê²©íŒ€ (3ëª…)</div>
                        
                        <div class="hero-grid">
                            <div class="hero-select-group">
                                <label>ê³µê²© ìœ ë‹› 1</label>
                                <select onchange="updateAttackHero(1, this.value)" required>
                                    <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                    <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                    <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                    <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                    <option value="í¬ê·€">í¬ê·€</option>
                                </select>
                                <select id="attackHero1" required disabled>
                                    <option value="">ì˜ì›… ì„ íƒ</option>
                                </select>
                            </div>
                            <div class="hero-select-group">
                                <label>ê³µê²© ìœ ë‹› 2</label>
                                <select onchange="updateAttackHero(2, this.value)" required>
                                    <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                    <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                    <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                    <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                    <option value="í¬ê·€">í¬ê·€</option>
                                </select>
                                <select id="attackHero2" required disabled>
                                    <option value="">ì˜ì›… ì„ íƒ</option>
                                </select>
                            </div>
                            <div class="hero-select-group">
                                <label>ê³µê²© ìœ ë‹› 3</label>
                                <select onchange="updateAttackHero(3, this.value)" required>
                                    <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                    <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                    <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                    <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                    <option value="í¬ê·€">í¬ê·€</option>
                                </select>
                                <select id="attackHero3" required disabled>
                                    <option value="">ì˜ì›… ì„ íƒ</option>
                                </select>
                            </div>
                        </div>

                        <!-- ì˜ì›… 1 ì¥ë¹„ -->
                        <div class="equipment-title">
                            <span id="hero1Title">ğŸ¯ ì˜ì›…1 ì¥ë¹„ ì„¸íŒ…</span>
                            <div class="upload-btn-inline">
                                <div class="upload-btn"><span>ğŸ“</span><span>ì‚¬ì§„ë“±ë¡</span></div>
                                <input type="file" accept="image/*" multiple onchange="handleImageUpload(1, this.files)">
                            </div>
                        </div>
                        
                        <div class="hero-equipment-layout">
                            <div>
                                <div id="hero1Images" class="image-preview-container">
                                    <div class="image-preview-item">ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”</div>
                                    <div class="image-preview-item">ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”</div>
                                </div>
                            </div>
                            <div>
                                <div class="form-group">
                                    <label>ê³µí†µ ì„¸íŠ¸</label>
                                    <select id="hero1Set">
                                        <option value="ëª¨ë‘">ëª¨ë‘</option>
                                        <option value="ì„ ë´‰ì¥">ì„ ë´‰ì¥</option>
                                        <option value="ì„±ê¸°ì‚¬">ì„±ê¸°ì‚¬</option>
                                        <option value="ì•”ì‚´ì">ì•”ì‚´ì</option>
                                        <option value="ë³µìˆ˜ì">ë³µìˆ˜ì</option>
                                        <option value="ì¡°ìœ¨ì">ì¡°ìœ¨ì</option>
                                        <option value="ìˆ˜ë¬¸ì¥">ìˆ˜ë¬¸ì¥</option>
                                        <option value="ìˆ˜í˜¸ì">ìˆ˜í˜¸ì</option>
                                        <option value="ì¶”ì ì">ì¶”ì ì</option>
                                        <option value="ì£¼ìˆ ì‚¬">ì£¼ìˆ ì‚¬</option>
                                    </select>
                                </div>
                                <div class="equipment-grid">
                                    <div class="equipment-item">
                                        <div class="equipment-item-title">âš”ï¸ ë¬´ê¸°</div>
                                        <div class="equipment-options">
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë¬´ê¸°1 ì˜µì…˜</label>
                                                <select id="hero1Weapon1" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; background: white; cursor: pointer;">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ì•½ì  ê³µê²© í™•ë¥ ">ì•½ì  ê³µê²© í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í™•ë¥ ">ì¹˜ëª…íƒ€ í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í”¼í•´">ì¹˜ëª…íƒ€ í”¼í•´</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì ì¤‘">íš¨ê³¼ ì ì¤‘</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë¬´ê¸°2 ì˜µì…˜</label>
                                                <select id="hero1Weapon2">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ì•½ì  ê³µê²© í™•ë¥ ">ì•½ì  ê³µê²© í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í™•ë¥ ">ì¹˜ëª…íƒ€ í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í”¼í•´">ì¹˜ëª…íƒ€ í”¼í•´</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì ì¤‘">íš¨ê³¼ ì ì¤‘</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="equipment-item">
                                        <div class="equipment-item-title">ğŸ›¡ï¸ ë°©ì–´êµ¬</div>
                                        <div class="equipment-options">
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë°©ì–´êµ¬1 ì˜µì…˜</label>
                                                <select id="hero1Armor1">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ë°›ëŠ” í”¼í•´ ê°ì†Œ">ë°›ëŠ” í”¼í•´ ê°ì†Œ</option>
                                                    <option value="ë§‰ê¸° í™•ë¥ ">ë§‰ê¸° í™•ë¥ </option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì €í•­">íš¨ê³¼ ì €í•­</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë°©ì–´êµ¬2 ì˜µì…˜</label>
                                                <select id="hero1Armor2">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ë°›ëŠ” í”¼í•´ ê°ì†Œ">ë°›ëŠ” í”¼í•´ ê°ì†Œ</option>
                                                    <option value="ë§‰ê¸° í™•ë¥ ">ë§‰ê¸° í™•ë¥ </option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì €í•­">íš¨ê³¼ ì €í•­</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group" style="margin-top: 15px; margin-bottom: 0;">
                                    <label>ğŸ’¬ ì¥ë¹„ ì„¤ëª…</label>
                                    <textarea id="hero1Desc" rows="2" placeholder="ì´ ê³µê²© ìœ ë‹›ì˜ ì¥ë¹„ íŠ¹ì§•, ì„¸íŒ… ì´ìœ  ë“±ì„ ì‘ì„±í•˜ì„¸ìš”"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- ì˜ì›… 2 ì¥ë¹„ (ë™ì¼ êµ¬ì¡°) -->
                        <div class="equipment-title">
                            <span id="hero2Title">ğŸ¯ ì˜ì›…2 ì¥ë¹„ ì„¸íŒ…</span>
                            <div class="upload-btn-inline">
                                <div class="upload-btn"><span>ğŸ“</span><span>ì‚¬ì§„ë“±ë¡</span></div>
                                <input type="file" accept="image/*" multiple onchange="handleImageUpload(2, this.files)">
                            </div>
                        </div>
                        
                        <div class="hero-equipment-layout">
                            <div>
                                <div id="hero2Images" class="image-preview-container">
                                    <div class="image-preview-item">ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”</div>
                                </div>
                            </div>
                            <div>
                                <div class="form-group">
                                    <label>ê³µí†µ ì„¸íŠ¸</label>
                                    <select id="hero2Set">
                                        <option value="ëª¨ë‘">ëª¨ë‘</option>
                                        <option value="ì„ ë´‰ì¥">ì„ ë´‰ì¥</option>
                                        <option value="ì„±ê¸°ì‚¬">ì„±ê¸°ì‚¬</option>
                                        <option value="ì•”ì‚´ì">ì•”ì‚´ì</option>
                                        <option value="ë³µìˆ˜ì">ë³µìˆ˜ì</option>
                                        <option value="ì¡°ìœ¨ì">ì¡°ìœ¨ì</option>
                                        <option value="ìˆ˜ë¬¸ì¥">ìˆ˜ë¬¸ì¥</option>
                                        <option value="ìˆ˜í˜¸ì">ìˆ˜í˜¸ì</option>
                                        <option value="ì¶”ì ì">ì¶”ì ì</option>
                                        <option value="ì£¼ìˆ ì‚¬">ì£¼ìˆ ì‚¬</option>
                                    </select>
                                </div>
                                <div class="equipment-grid">
                                    <div class="equipment-item">
                                        <div class="equipment-item-title">âš”ï¸ ë¬´ê¸°</div>
                                        <div class="equipment-options">
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë¬´ê¸°1 ì˜µì…˜</label>
                                                <select id="hero2Weapon1">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ì•½ì  ê³µê²© í™•ë¥ ">ì•½ì  ê³µê²© í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í™•ë¥ ">ì¹˜ëª…íƒ€ í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í”¼í•´">ì¹˜ëª…íƒ€ í”¼í•´</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì ì¤‘">íš¨ê³¼ ì ì¤‘</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë¬´ê¸°2 ì˜µì…˜</label>
                                                <select id="hero2Weapon2">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ì•½ì  ê³µê²© í™•ë¥ ">ì•½ì  ê³µê²© í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í™•ë¥ ">ì¹˜ëª…íƒ€ í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í”¼í•´">ì¹˜ëª…íƒ€ í”¼í•´</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì ì¤‘">íš¨ê³¼ ì ì¤‘</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="equipment-item">
                                        <div class="equipment-item-title">ğŸ›¡ï¸ ë°©ì–´êµ¬</div>
                                        <div class="equipment-options">
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë°©ì–´êµ¬1 ì˜µì…˜</label>
                                                <select id="hero2Armor1">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ë°›ëŠ” í”¼í•´ ê°ì†Œ">ë°›ëŠ” í”¼í•´ ê°ì†Œ</option>
                                                    <option value="ë§‰ê¸° í™•ë¥ ">ë§‰ê¸° í™•ë¥ </option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì €í•­">íš¨ê³¼ ì €í•­</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë°©ì–´êµ¬2 ì˜µì…˜</label>
                                                <select id="hero2Armor2">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ë°›ëŠ” í”¼í•´ ê°ì†Œ">ë°›ëŠ” í”¼í•´ ê°ì†Œ</option>
                                                    <option value="ë§‰ê¸° í™•ë¥ ">ë§‰ê¸° í™•ë¥ </option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì €í•­">íš¨ê³¼ ì €í•­</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group" style="margin-top: 15px; margin-bottom: 0;">
                                    <label>ğŸ’¬ ì¥ë¹„ ì„¤ëª…</label>
                                    <textarea id="hero2Desc" rows="2" placeholder="ì´ ê³µê²© ìœ ë‹›ì˜ ì¥ë¹„ íŠ¹ì§•, ì„¸íŒ… ì´ìœ  ë“±ì„ ì‘ì„±í•˜ì„¸ìš”"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- ì˜ì›… 3 ì¥ë¹„ (ë™ì¼ êµ¬ì¡°) -->
                        <div class="equipment-title">
                            <span id="hero3Title">ğŸ¯ ì˜ì›…3 ì¥ë¹„ ì„¸íŒ…</span>
                            <div class="upload-btn-inline">
                                <div class="upload-btn"><span>ğŸ“</span><span>ì‚¬ì§„ë“±ë¡</span></div>
                                <input type="file" accept="image/*" multiple onchange="handleImageUpload(3, this.files)">
                            </div>
                        </div>
                        
                        <div class="hero-equipment-layout">
                            <div>
                                <div id="hero3Images" class="image-preview-container">
                                    <div class="image-preview-item">ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”</div>
                                </div>
                            </div>
                            <div>
                                <div class="form-group">
                                    <label>ê³µí†µ ì„¸íŠ¸</label>
                                    <select id="hero3Set">
                                        <option value="ëª¨ë‘">ëª¨ë‘</option>
                                        <option value="ì„ ë´‰ì¥">ì„ ë´‰ì¥</option>
                                        <option value="ì„±ê¸°ì‚¬">ì„±ê¸°ì‚¬</option>
                                        <option value="ì•”ì‚´ì">ì•”ì‚´ì</option>
                                        <option value="ë³µìˆ˜ì">ë³µìˆ˜ì</option>
                                        <option value="ì¡°ìœ¨ì">ì¡°ìœ¨ì</option>
                                        <option value="ìˆ˜ë¬¸ì¥">ìˆ˜ë¬¸ì¥</option>
                                        <option value="ìˆ˜í˜¸ì">ìˆ˜í˜¸ì</option>
                                        <option value="ì¶”ì ì">ì¶”ì ì</option>
                                        <option value="ì£¼ìˆ ì‚¬">ì£¼ìˆ ì‚¬</option>
                                    </select>
                                </div>
                                <div class="equipment-grid">
                                    <div class="equipment-item">
                                        <div class="equipment-item-title">âš”ï¸ ë¬´ê¸°</div>
                                        <div class="equipment-options">
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë¬´ê¸°1 ì˜µì…˜</label>
                                                <select id="hero3Weapon1">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ì•½ì  ê³µê²© í™•ë¥ ">ì•½ì  ê³µê²© í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í™•ë¥ ">ì¹˜ëª…íƒ€ í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í”¼í•´">ì¹˜ëª…íƒ€ í”¼í•´</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì ì¤‘">íš¨ê³¼ ì ì¤‘</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë¬´ê¸°2 ì˜µì…˜</label>
                                                <select id="hero3Weapon2">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ì•½ì  ê³µê²© í™•ë¥ ">ì•½ì  ê³µê²© í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í™•ë¥ ">ì¹˜ëª…íƒ€ í™•ë¥ </option>
                                                    <option value="ì¹˜ëª…íƒ€ í”¼í•´">ì¹˜ëª…íƒ€ í”¼í•´</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì ì¤‘">íš¨ê³¼ ì ì¤‘</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="equipment-item">
                                        <div class="equipment-item-title">ğŸ›¡ï¸ ë°©ì–´êµ¬</div>
                                        <div class="equipment-options">
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë°©ì–´êµ¬1 ì˜µì…˜</label>
                                                <select id="hero3Armor1">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ë°›ëŠ” í”¼í•´ ê°ì†Œ">ë°›ëŠ” í”¼í•´ ê°ì†Œ</option>
                                                    <option value="ë§‰ê¸° í™•ë¥ ">ë§‰ê¸° í™•ë¥ </option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì €í•­">íš¨ê³¼ ì €í•­</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="font-size: 0.85em; color: #666; margin-bottom: 5px; display: block;">ë°©ì–´êµ¬2 ì˜µì…˜</label>
                                                <select id="hero3Armor2">
                                                    <option value="ëª¨ë‘">ëª¨ë‘</option>
                                                    <option value="ë°›ëŠ” í”¼í•´ ê°ì†Œ">ë°›ëŠ” í”¼í•´ ê°ì†Œ</option>
                                                    <option value="ë§‰ê¸° í™•ë¥ ">ë§‰ê¸° í™•ë¥ </option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥(%)">ëª¨ë“  ê³µê²©ë ¥(%)</option>
                                                    <option value="ëª¨ë“  ê³µê²©ë ¥">ëª¨ë“  ê³µê²©ë ¥</option>
                                                    <option value="ë°©ì–´ë ¥(%)">ë°©ì–´ë ¥(%)</option>
                                                    <option value="ë°©ì–´ë ¥">ë°©ì–´ë ¥</option>
                                                    <option value="ìƒëª…ë ¥(%)">ìƒëª…ë ¥(%)</option>
                                                    <option value="ìƒëª…ë ¥">ìƒëª…ë ¥</option>
                                                    <option value="íš¨ê³¼ ì €í•­">íš¨ê³¼ ì €í•­</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group" style="margin-top: 15px; margin-bottom: 0;">
                                    <label>ğŸ’¬ ì¥ë¹„ ì„¤ëª…</label>
                                    <textarea id="hero3Desc" rows="2" placeholder="ì´ ê³µê²© ìœ ë‹›ì˜ ì¥ë¹„ íŠ¹ì§•, ì„¸íŒ… ì´ìœ  ë“±ì„ ì‘ì„±í•˜ì„¸ìš”"></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="skill-order-section">
                            <h4>ğŸ˜Š ìŠ¤í‚¬ ì‚¬ìš© ìˆœì„œ</h4>
                            <p>ê° ì˜ì›…ì˜ ìŠ¤í‚¬ ì‚¬ìš© ìˆœì„œë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                            
                            <!-- ìŠ¤í‚¬ í‘œì‹œ ì˜ì—­ -->
                            <div id="skillDisplay" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px;">
                                <div style="text-align: center;">
                                    <div style="padding: 10px; background: rgba(255,182,193,0.3); border-radius: 8px; margin-bottom: 5px; color: #666; font-size: 0.9em;">
                                        <span id="hero1NameSkill">ì˜ì›…1</span> ìŠ¤í‚¬2
                                    </div>
                                    <div style="padding: 10px; background: rgba(255,182,193,0.5); border-radius: 8px; color: #333; font-weight: 600; font-size: 0.9em;">
                                        <span id="hero1NameSkill2">ì˜ì›…1</span> ìŠ¤í‚¬1
                                    </div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="padding: 10px; background: rgba(152,216,200,0.3); border-radius: 8px; margin-bottom: 5px; color: #666; font-size: 0.9em;">
                                        <span id="hero2NameSkill">ì˜ì›…2</span> ìŠ¤í‚¬2
                                    </div>
                                    <div style="padding: 10px; background: rgba(152,216,200,0.5); border-radius: 8px; color: #333; font-weight: 600; font-size: 0.9em;">
                                        <span id="hero2NameSkill2">ì˜ì›…2</span> ìŠ¤í‚¬1
                                    </div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="padding: 10px; background: rgba(176,138,176,0.3); border-radius: 8px; margin-bottom: 5px; color: #666; font-size: 0.9em;">
                                        <span id="hero3NameSkill">ì˜ì›…3</span> ìŠ¤í‚¬2
                                    </div>
                                    <div style="padding: 10px; background: rgba(176,138,176,0.5); border-radius: 8px; color: #333; font-weight: 600; font-size: 0.9em;">
                                        <span id="hero3NameSkill2">ì˜ì›…3</span> ìŠ¤í‚¬1
                                    </div>
                                </div>
                            </div>
                            
                            <p style="font-weight: 600; margin-bottom: 10px;">ìŠ¤í‚¬ ìˆœì„œ (3ê°œ ì„ íƒ)</p>
                            <div class="skill-order-grid">
                                <div>
                                    <label style="font-size: 0.9em; color: #666; margin-bottom: 5px; display: block;">1ìˆœìœ„</label>
                                    <select id="skill1">
                                        <option value="">ì„ íƒ</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 0.9em; color: #666; margin-bottom: 5px; display: block;">2ìˆœìœ„</label>
                                    <select id="skill2">
                                        <option value="">ì„ íƒ</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 0.9em; color: #666; margin-bottom: 5px; display: block;">3ìˆœìœ„</label>
                                    <select id="skill3">
                                        <option value="">ì„ íƒ</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="form-group" style="margin-top: 25px;">
                            <label>ğŸ’¡ ìš´ìš© íŒ</label>
                            <textarea id="operationTip" rows="4" placeholder="ì „ëµ ìš´ìš©ë²•, ì£¼ì˜ì‚¬í•­, íŒ ë“±ì„ ìì„¸íˆ ì‘ì„±í•´ì£¼ì„¸ìš”"></textarea>
                        </div>
                    </div>

                    <button type="submit" class="btn">âœ… ê³µëµ ë“±ë¡í•˜ê¸°</button>
                </form>
            </div>
        </div>

        <!-- ê³µëµ ëª©ë¡ íƒ­ -->
        <div id="list-tab" class="tab-content">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="ğŸ” ê³µëµ ì´ë¦„, ì˜ì›… ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰..." onkeyup="searchStrategies()">
            </div>
            <div id="strategyList" class="strategy-list"></div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, query, orderBy, updateDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getStorage, ref, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';

        const firebaseConfig = {
            apiKey: "AIzaSyAIuUCCt5RfN5Jv9THi3-OAn1F4xJ7TH4U",
            authDomain: "gyuomi-guild.firebaseapp.com",
            projectId: "gyuomi-guild",
            storageBucket: "gyuomi-guild.firebasestorage.app",
            messagingSenderId: "43293575259",
            appId: "1:43293575259:web:2ac8bd0dfecda6a2be177e"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        let currentUser = null;
        let strategies = [];
        const hero1Images = [];
        const hero2Images = [];
        const hero3Images = [];

        const heroData = {
            'êµ¬ì„¸ë‚˜': ['ë°€ë¦¬ì•„', 'ê°¤ë¦¬ë‘ìŠ¤', 'íŒŒì´', 'ì¥¬ë¦¬', 'ë¡œì§€'],
            'ì°ìŠ¤': ['ë¸Œë€ì¦ˆ&ë¸Œë€ì…€', 'ì†ì˜¤ê³µ', 'í”„ë ˆì´ì•¼', 'íŠ¸ë£¨ë“œ', 'ë¼ì´ì–¸', 'ì—˜ë¦¬ì‹œì•„', 'í‚¤ë¦¬ì—˜', 'ì¹´ì¼', 'ì•„í‚¬ë¼', 'ì¹´êµ¬ë¼', 'í´ë¼í•œ', 'ì˜¤ë¥¼ë¦¬', 'ë¹„ìŠ¤í‚·', 'í”Œë¼íŠ¼', 'ì½œíŠ¸', 'ë¦°', 'ì¹´ë¥´ë§ˆ', 'ë©œí‚¤ë¥´', 'ì—°í¬', 'íƒœì˜¤', 'ë°”ë„¤ì‚¬', 'ìŠ¤íŒŒì´í¬', 'ì œì´ë¸Œ', 'ë ˆì´ì²¼', 'ì•„ì¼ë¦°', 'ë¸ë¡ ì¦ˆ', 'í¬ë¦¬ìŠ¤', 'ë£¨ë””', 'ì‹¤ë² ìŠ¤íƒ€', 'ì—ì´ìŠ¤'],
            'ì§­ìŠ¤': ['ë°±ê°', 'ì•„ë©œë¦¬ì•„', 'ë¯¸í˜¸', 'ë°ì´ì§€', 'íƒ€ì¹´', 'íŒŒìŠ¤ì¹¼', 'ì•„ë¼ê³¤', 'ì—˜ë¦¬ìŠ¤', 'ë°œë¦¬ìŠ¤íƒ€', 'ì²¸ìŠ¬ëŸ¬', 'ë£©', 'ì§€í¬', 'ì„¸ì¸', 'ì—ìŠ¤íŒŒë‹¤', 'ë‹ˆì•„', 'ë£¨ë¦¬', 'ë²¨ë¦¬ì¹´', 'ë¦¬ë‚˜', 'ë¹„ë‹´', 'ìœ ì‹ ', 'ë…¹ìŠ¤'],
            'í¬ê·€': ['ë ˆì´', 'ì§„', 'ìºí‹°', 'ë¸”ë™ë¡œì¦ˆ', 'ì•„ìˆ˜ë¼', 'ë…¸í˜¸', 'í´ë¡œì—', 'ë©”ì´', 'ì„¸ë¼', 'ì œì¸', 'ìœ ì´', 'ì‹¤ë¹„ì•„', 'ë£¨ì‹œ', 'ë¹…í† ë¦¬ì•„', 'ì¹´ë¡ ', 'ì¡°ì»¤', 'ì¹´ë¦°', 'ì—ë°˜', 'ì¥¬í”¼', 'ìŠ¤ë‹ˆí¼', 'ì†Œì´', 'í’ì—°', 'í—¤ë¸Œë‹ˆì•„', 'í—¬ë ˆë‹ˆì•„', 'ì•„ë¦¬ì—˜', 'ë¦¬', 'ì‚¬ë¼', 'ë¼ë‹ˆì•„', 'í´ë ˆì˜¤', 'ë² ì¸', 'ë ˆì˜¤', 'ìœ ë¦¬', 'ë¼ì¿¤', 'í˜¸í‚¨']
        };

        Object.keys(heroData).forEach(grade => {
            heroData[grade].sort((a, b) => a.localeCompare(b, 'ko'));
        });

        onAuthStateChanged(auth, async (user) => {
            if (!user) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                window.location.href = 'index.html';
                return;
            }

            try {
                const userDoc = await getDocs(query(collection(db, 'users')));
                let userData = null;
                userDoc.forEach(doc => {
                    if (doc.data().email === user.email) {
                        userData = { uid: doc.id, ...doc.data() };
                    }
                });

                if (!userData || userData.role === 'pending') {
                    alert('ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì´ê±°ë‚˜ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.');
                    await auth.signOut();
                    window.location.href = 'index.html';
                    return;
                }

                currentUser = userData;
                loadStrategies();
            } catch (error) {
                console.error('ì‚¬ìš©ì ì •ë³´ ë¡œë“œ ì˜¤ë¥˜:', error);
                window.location.href = 'index.html';
            }
        });

        window.switchTab = function(tab) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`${tab}-tab`).classList.add('active');
            event.target.classList.add('active');
        };

        window.updateDefenseHero = function(num, grade) {
            const select = document.getElementById(`defenseHero${num}`);
            select.disabled = false;
            select.innerHTML = '<option value="">ì˜ì›… ì„ íƒ</option>';
            if (heroData[grade]) {
                heroData[grade].forEach(hero => {
                    const option = document.createElement('option');
                    option.value = hero;
                    option.textContent = hero;
                    select.appendChild(option);
                });
            }
        };

        window.updateAttackHero = function(num, grade) {
            const select = document.getElementById(`attackHero${num}`);
            select.disabled = false;
            select.innerHTML = '<option value="">ì˜ì›… ì„ íƒ</option>';
            if (heroData[grade]) {
                heroData[grade].forEach(hero => {
                    const option = document.createElement('option');
                    option.value = hero;
                    option.textContent = hero;
                    select.appendChild(option);
                });
            }
            
            // ì˜ì›… ì„ íƒì‹œ ì œëª© ì—…ë°ì´íŠ¸
            select.addEventListener('change', function() {
                updateHeroTitle(num, this.value);
                updateSkillOptions();
            });
        };

        function updateHeroTitle(heroNum, heroName) {
            const titleElement = document.getElementById(`hero${heroNum}Title`);
            if (titleElement && heroName) {
                titleElement.textContent = `ğŸ¯ ì˜ì›…${heroNum} - ${heroName} ì¥ë¹„ ì„¸íŒ…`;
            }
            
            // ìŠ¤í‚¬ í‘œì‹œ ì˜ì—­ë„ ì—…ë°ì´íŠ¸
            const skillSpan1 = document.getElementById(`hero${heroNum}NameSkill`);
            const skillSpan2 = document.getElementById(`hero${heroNum}NameSkill2`);
            if (skillSpan1 && heroName) skillSpan1.textContent = heroName;
            if (skillSpan2 && heroName) skillSpan2.textContent = heroName;
        }

        function updateSkillOptions() {
            const hero1 = document.getElementById('attackHero1').value;
            const hero2 = document.getElementById('attackHero2').value;
            const hero3 = document.getElementById('attackHero3').value;
            
            const skillOptions = [];
            if (hero1) {
                skillOptions.push(`${hero1} ìŠ¤í‚¬1`);
                skillOptions.push(`${hero1} ìŠ¤í‚¬2`);
            }
            if (hero2) {
                skillOptions.push(`${hero2} ìŠ¤í‚¬1`);
                skillOptions.push(`${hero2} ìŠ¤í‚¬2`);
            }
            if (hero3) {
                skillOptions.push(`${hero3} ìŠ¤í‚¬1`);
                skillOptions.push(`${hero3} ìŠ¤í‚¬2`);
            }
            
            // ëª¨ë“  ìŠ¤í‚¬ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
            ['skill1', 'skill2', 'skill3'].forEach(id => {
                const select = document.getElementById(id);
                const currentValue = select.value;
                select.innerHTML = '<option value="">ì„ íƒ</option>';
                skillOptions.forEach(skill => {
                    const option = document.createElement('option');
                    option.value = skill;
                    option.textContent = skill;
                    select.appendChild(option);
                });
                if (currentValue && skillOptions.includes(currentValue)) {
                    select.value = currentValue;
                }
            });
        }

        window.handleImageUpload = function(heroNum, files) {
            const container = document.getElementById(`hero${heroNum}Images`);
            const imageArray = heroNum === 1 ? hero1Images : heroNum === 2 ? hero2Images : hero3Images;
            
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    imageArray.push(file);
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        renderImages(heroNum);
                    };
                    reader.readAsDataURL(file);
                }
            });
        };

        function renderImages(heroNum) {
            const container = document.getElementById(`hero${heroNum}Images`);
            const imageArray = heroNum === 1 ? hero1Images : heroNum === 2 ? hero2Images : hero3Images;
            
            container.innerHTML = '';
            
            if (imageArray.length === 0) {
                container.innerHTML = `
                    <div class="image-preview-item">ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”</div>
                    ${heroNum === 1 ? '<div class="image-preview-item">ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”</div>' : ''}
                `;
                return;
            }
            
            imageArray.forEach((file, idx) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const div = document.createElement('div');
                    div.className = 'image-preview-item';
                    div.innerHTML = `
                        <img src="${e.target.result}" alt="ë¯¸ë¦¬ë³´ê¸°">
                        <button type="button" class="image-remove-btn" onclick="removeImage(${heroNum}, ${idx})">Ã—</button>
                    `;
                    container.appendChild(div);
                };
                reader.readAsDataURL(file);
            });
        }

        window.removeImage = function(heroNum, index) {
            const imageArray = heroNum === 1 ? hero1Images : heroNum === 2 ? hero2Images : hero3Images;
            imageArray.splice(index, 1);
            renderImages(heroNum);
        };

        window.saveStrategy = async function(e) {
            e.preventDefault();
            
            const form = e.target;
            const editId = form.getAttribute('data-edit-id');
            const existingStrategyJson = form.getAttribute('data-existing-strategy');
            const isEditMode = !!editId;
            
            // í•„ìˆ˜ í•„ë“œ ê²€ì¦
            if (!document.getElementById('strategyName').value.trim()) {
                alert('ê³µëµ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!document.getElementById('defenseHero1').value || 
                !document.getElementById('defenseHero2').value || 
                !document.getElementById('defenseHero3').value) {
                alert('ìƒëŒ€ ë°©ì–´íŒ€ ì˜ì›… 3ëª…ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!document.getElementById('attackHero1').value ||
                !document.getElementById('attackHero2').value ||
                !document.getElementById('attackHero3').value) {
                alert('ê³µê²©íŒ€ ì˜ì›… 3ëª…ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                console.log(isEditMode ? 'ê³µëµ ìˆ˜ì • ì‹œì‘...' : 'ê³µëµ ì €ì¥ ì‹œì‘...');
                
                // ì´ë¯¸ì§€ ì—…ë¡œë“œ í•¨ìˆ˜
                const uploadImages = async (images) => {
                    const urls = [];
                    if (!images || images.length === 0) {
                        console.log('ì—…ë¡œë“œí•  ì´ë¯¸ì§€ ì—†ìŒ');
                        return urls;
                    }
                    
                    for (const file of images) {
                        try {
                            const timestamp = Date.now();
                            const randomStr = Math.random().toString(36).substring(7);
                            const fileName = `${timestamp}_${randomStr}.jpg`;
                            const storageRef = ref(storage, `strategies/${fileName}`);
                            
                            console.log('ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹œë„:', fileName);
                            await uploadBytes(storageRef, file);
                            const url = await getDownloadURL(storageRef);
                            urls.push(url);
                            console.log('ì´ë¯¸ì§€ ì—…ë¡œë“œ ì„±ê³µ:', url);
                        } catch (error) {
                            console.warn('ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨ (ë¬´ì‹œí•˜ê³  ê³„ì†):', error.message);
                        }
                    }
                    return urls;
                };

                console.log('ì´ë¯¸ì§€ ì—…ë¡œë“œ ì¤‘...');
                let hero1ImageUrls = [];
                let hero2ImageUrls = [];
                let hero3ImageUrls = [];
                
                // ìˆ˜ì • ëª¨ë“œì¼ ê²½ìš° ê¸°ì¡´ ì´ë¯¸ì§€ ì‚¬ìš©
                if (isEditMode && existingStrategyJson) {
                    const existingStrategy = JSON.parse(existingStrategyJson);
                    hero1ImageUrls = existingStrategy.attackTeam.hero1.images || [];
                    hero2ImageUrls = existingStrategy.attackTeam.hero2.images || [];
                    hero3ImageUrls = existingStrategy.attackTeam.hero3.images || [];
                }
                
                // ìƒˆ ì´ë¯¸ì§€ê°€ ìˆìœ¼ë©´ ì—…ë¡œë“œ (ê¸°ì¡´ ì´ë¯¸ì§€ ëŒ€ì²´)
                try {
                    if (hero1Images.length > 0) hero1ImageUrls = await uploadImages(hero1Images);
                    if (hero2Images.length > 0) hero2ImageUrls = await uploadImages(hero2Images);
                    if (hero3Images.length > 0) hero3ImageUrls = await uploadImages(hero3Images);
                    console.log('ì´ë¯¸ì§€ ì—…ë¡œë“œ ì™„ë£Œ');
                } catch (error) {
                    console.warn('ì´ë¯¸ì§€ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ (ë¬´ì‹œí•˜ê³  ê³„ì†):', error);
                }

                const strategyData = {
                    name: document.getElementById('strategyName').value.trim(),
                    defenseTeam: {
                        hero1: document.getElementById('defenseHero1').value,
                        hero2: document.getElementById('defenseHero2').value,
                        hero3: document.getElementById('defenseHero3').value
                    },
                    attackTeam: {
                        hero1: {
                            name: document.getElementById('attackHero1').value,
                            set: document.getElementById('hero1Set').value,
                            weapon1: document.getElementById('hero1Weapon1').value,
                            weapon2: document.getElementById('hero1Weapon2').value,
                            armor1: document.getElementById('hero1Armor1').value,
                            armor2: document.getElementById('hero1Armor2').value,
                            description: document.getElementById('hero1Desc').value,
                            images: hero1ImageUrls
                        },
                        hero2: {
                            name: document.getElementById('attackHero2').value,
                            set: document.getElementById('hero2Set').value,
                            weapon1: document.getElementById('hero2Weapon1').value,
                            weapon2: document.getElementById('hero2Weapon2').value,
                            armor1: document.getElementById('hero2Armor1').value,
                            armor2: document.getElementById('hero2Armor2').value,
                            description: document.getElementById('hero2Desc').value,
                            images: hero2ImageUrls
                        },
                        hero3: {
                            name: document.getElementById('attackHero3').value,
                            set: document.getElementById('hero3Set').value,
                            weapon1: document.getElementById('hero3Weapon1').value,
                            weapon2: document.getElementById('hero3Weapon2').value,
                            armor1: document.getElementById('hero3Armor1').value,
                            armor2: document.getElementById('hero3Armor2').value,
                            description: document.getElementById('hero3Desc').value,
                            images: hero3ImageUrls
                        }
                    },
                    skills: {
                        skill1: document.getElementById('skill1').value || '',
                        skill2: document.getElementById('skill2').value || '',
                        skill3: document.getElementById('skill3').value || ''
                    },
                    operationTip: document.getElementById('operationTip').value,
                    author: currentUser.nickname,
                    authorUid: currentUser.uid,
                    createdAt: isEditMode ? (JSON.parse(existingStrategyJson).createdAt || new Date().toISOString()) : new Date().toISOString()
                };

                console.log('Firestore ì €ì¥ ì‹œì‘:', strategyData);
                
                if (isEditMode) {
                    await updateDoc(doc(db, 'attack_strategies', editId), {
                        ...strategyData,
                        updatedAt: new Date().toISOString()
                    });
                    console.log('Firestore ìˆ˜ì • ì™„ë£Œ:', editId);
                    alert('ê³µëµì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!');
                } else {
                    const docRef = await addDoc(collection(db, 'attack_strategies'), strategyData);
                    console.log('Firestore ì €ì¥ ì™„ë£Œ:', docRef.id);
                    alert('ê³µëµì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }
                
                // í¼ ì´ˆê¸°í™”
                document.getElementById('strategyForm').reset();
                form.removeAttribute('data-edit-id');
                form.removeAttribute('data-existing-strategy');
                
                // ì·¨ì†Œ ë²„íŠ¼ ì œê±°
                const cancelBtn = document.getElementById('cancelEditBtn');
                if (cancelBtn) cancelBtn.remove();
                
                // ë²„íŠ¼ í…ìŠ¤íŠ¸ ì›ë³µ
                const submitBtn = form.querySelector('button[type="submit"]');
                submitBtn.textContent = 'âœ… ê³µëµ ë“±ë¡í•˜ê¸°';
                
                hero1Images.length = 0;
                hero2Images.length = 0;
                hero3Images.length = 0;
                renderImages(1);
                renderImages(2);
                renderImages(3);
                
                // ìŠ¤í‚¬ í‘œì‹œ ì´ˆê¸°í™”
                ['hero1NameSkill', 'hero1NameSkill2', 'hero2NameSkill', 'hero2NameSkill2', 'hero3NameSkill', 'hero3NameSkill2'].forEach(id => {
                    const elem = document.getElementById(id);
                    if (elem) elem.textContent = id.includes('hero1') ? 'ì˜ì›…1' : id.includes('hero2') ? 'ì˜ì›…2' : 'ì˜ì›…3';
                });
                
                loadStrategies();
                switchTab('list');
            } catch (error) {
                console.error('ê³µëµ ì €ì¥/ìˆ˜ì • ì˜¤ë¥˜:', error);
                console.error('ì˜¤ë¥˜ ìƒì„¸:', error.message);
                console.error('ì˜¤ë¥˜ ìŠ¤íƒ:', error.stack);
                alert('ê³µëµ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        };

        async function loadStrategies() {
            try {
                console.log('ê³µëµ ëª©ë¡ ë¡œë“œ ì‹œì‘...');
                const snapshot = await getDocs(query(collection(db, 'attack_strategies'), orderBy('createdAt', 'desc')));
                strategies = [];
                snapshot.forEach(doc => {
                    strategies.push({ id: doc.id, ...doc.data() });
                });

                console.log('ë¡œë“œëœ ê³µëµ ìˆ˜:', strategies.length);
                document.getElementById('strategyCount').textContent = strategies.length;
                renderStrategies();
            } catch (error) {
                console.error('ê³µëµ ë¡œë“œ ì˜¤ë¥˜:', error);
                console.error('ì˜¤ë¥˜ ìƒì„¸:', error.message);
                // ì¸ë±ìŠ¤ ì˜¤ë¥˜ì¼ ê²½ìš° orderBy ì—†ì´ ì¬ì‹œë„
                if (error.code === 'failed-precondition' || error.message.includes('index')) {
                    console.log('ì¸ë±ìŠ¤ ì—†ì´ ì¬ì‹œë„...');
                    try {
                        const snapshot = await getDocs(collection(db, 'attack_strategies'));
                        strategies = [];
                        snapshot.forEach(doc => {
                            strategies.push({ id: doc.id, ...doc.data() });
                        });
                        // í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì •ë ¬
                        strategies.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                        console.log('ë¡œë“œëœ ê³µëµ ìˆ˜:', strategies.length);
                        document.getElementById('strategyCount').textContent = strategies.length;
                        renderStrategies();
                    } catch (retryError) {
                        console.error('ì¬ì‹œë„ ì‹¤íŒ¨:', retryError);
                        alert('ê³µëµ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } else {
                    alert('ê³µëµ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            }
        }

        function renderStrategies() {
            const container = document.getElementById('strategyList');
            
            if (strategies.length === 0) {
                container.innerHTML = '<div class="strategy-card"><p style="text-align: center; color: #999;">ë“±ë¡ëœ ê³µëµì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = strategies.map(strategy => {
                let html = `
                <div class="strategy-card">
                    <div class="strategy-header">
                        <div>
                            <div class="strategy-title">${strategy.name}</div>
                            <p style="color: #999; font-size: 0.9em; margin-top: 5px;">ì‘ì„±ì: ${strategy.author} | ${new Date(strategy.createdAt).toLocaleDateString()}</p>
                        </div>
                        ${currentUser && (currentUser.uid === strategy.authorUid || currentUser.role === 'admin') ? `
                            <div class="strategy-actions">
                                <button class="btn-edit" onclick="editStrategy('${strategy.id}')">ìˆ˜ì •</button>
                                <button class="btn-delete" onclick="deleteStrategy('${strategy.id}')">ì‚­ì œ</button>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div style="background: rgba(255,182,193,0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                        <strong style="color: #6B4966;">ğŸ›¡ï¸ ìƒëŒ€ ë°©ì–´íŒ€</strong>
                        <div class="hero-info" style="margin-top: 10px;">
                            <span class="hero-badge">${strategy.defenseTeam.hero1}</span>
                            <span class="hero-badge">${strategy.defenseTeam.hero2}</span>
                            <span class="hero-badge">${strategy.defenseTeam.hero3}</span>
                        </div>
                    </div>
                    
                    <div style="background: rgba(152,216,200,0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                        <strong style="color: #6B4966;">âš”ï¸ ê³µê²©íŒ€</strong>
                        <div class="hero-info" style="margin-top: 10px;">
                            <span class="hero-badge">${strategy.attackTeam.hero1.name}</span>
                            <span class="hero-badge">${strategy.attackTeam.hero2.name}</span>
                            <span class="hero-badge">${strategy.attackTeam.hero3.name}</span>
                        </div>
                    </div>`;
                
                // ì˜ì›… ì •ë³´ ë Œë”ë§ í•¨ìˆ˜
// ì˜ì›… ì •ë³´ ë Œë”ë§ í•¨ìˆ˜ (defense.html ìŠ¤íƒ€ì¼)
                const renderHero = (hero, colorCode, heroName) => {
                    const hasImages = hero.images && hero.images.length > 0;
                    
                    let heroHtml = `
                    <div style="background: rgba(152,216,200,0.05); padding: 25px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid ${colorCode};">
                        <h3 style="margin: 0 0 20px 0; color: ${colorCode}; font-size: 1.3em;">ğŸ¯ ${hero.name}</h3>`;
                    
                    if (hasImages) {
                        // 2ì—´ ë ˆì´ì•„ì›ƒ (ì‚¬ì§„ 300px)
                        heroHtml += `
                        <div style="display: grid; grid-template-columns: 300px 1fr; gap: 20px; align-items: start;">
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                ${hero.images.map(img => `
                                    <img src="${img}" 
                                         alt="ì¥ë¹„" 
                                         onclick="showImageModal('${img}')"
                                         style="width: 100%; height: auto; border-radius: 10px; border: 2px solid #e0e0e0; cursor: pointer; transition: transform 0.2s;"
                                         onmouseover="this.style.transform='scale(1.02)'"
                                         onmouseout="this.style.transform='scale(1)'">
                                `).join('')}
                            </div>
                            <div>`;
                    }
                    
                    // ì¥ë¹„ ì •ë³´ (defense.html ìŠ¤íƒ€ì¼)
                    heroHtml += `
                        <div style="margin-bottom: 12px;">
                            <span style="font-weight: 600; color: #666;">ğŸ“¦ ì„¸íŠ¸:</span> 
                            <span style="color: #333; font-size: 1.05em;">${hero.set || 'ë¯¸ì„¤ì •'}</span>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <span style="font-weight: 600; color: #666;">âš”ï¸ ë¬´ê¸°1:</span> 
                            <span style="color: #333; font-size: 1.05em;">${hero.weapon1 || 'ë¯¸ì„¤ì •'}</span>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <span style="font-weight: 600; color: #666;">âš”ï¸ ë¬´ê¸°2:</span> 
                            <span style="color: #333; font-size: 1.05em;">${hero.weapon2 || 'ë¯¸ì„¤ì •'}</span>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <span style="font-weight: 600; color: #666;">ğŸ›¡ï¸ ë°©ì–´êµ¬1:</span> 
                            <span style="color: #333; font-size: 1.05em;">${hero.armor1 || 'ë¯¸ì„¤ì •'}</span>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <span style="font-weight: 600; color: #666;">ğŸ›¡ï¸ ë°©ì–´êµ¬2:</span> 
                            <span style="color: #333; font-size: 1.05em;">${hero.armor2 || 'ë¯¸ì„¤ì •'}</span>
                        </div>`;
                    
if (hero.description) {
    heroHtml += `
    <div style="margin-top: 15px; padding: 12px; background: rgba(152,216,200,0.1); border-radius: 8px; border-left: 3px solid ${colorCode};">
        <span style="font-weight: 600; color: #666;">ğŸ’¬ ì¥ë¹„ ì„¤ëª…:</span><br>
        <span style="color: #555; line-height: 1.6; white-space: pre-wrap;">${hero.description}</span>
    </span>
                        </div>`;
                    }
                    
                    if (hasImages) {
                        heroHtml += `</div></div>`;
                    }
                    
                    heroHtml += `</div>`;
                    return heroHtml;
                };
                // ì˜ì›…1, 2, 3 ì •ë³´
                if (strategy.attackTeam.hero1) {
                    html += renderHero(strategy.attackTeam.hero1, '#FFB6C1');
                }
                if (strategy.attackTeam.hero2) {
                    html += renderHero(strategy.attackTeam.hero2, '#98D8C8');
                }
                if (strategy.attackTeam.hero3) {
                    html += renderHero(strategy.attackTeam.hero3, '#B08AB0');
                }
                
                // ìŠ¤í‚¬ ìˆœì„œ
                if (strategy.skills && (strategy.skills.skill1 || strategy.skills.skill2 || strategy.skills.skill3)) {
                    html += `
                    <div style="background: rgba(255,253,208,0.5); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                        <strong style="color: #6B4966;">â­ ìŠ¤í‚¬ ì‚¬ìš© ìˆœì„œ</strong>
                        <div style="margin-top: 10px; display: flex; gap: 10px; flex-wrap: wrap;">
                            ${strategy.skills.skill1 ? `<span class="hero-badge" style="background: #ffd93d;">1ìˆœìœ„: ${strategy.skills.skill1}</span>` : ''}
                            ${strategy.skills.skill2 ? `<span class="hero-badge" style="background: #ffd93d;">2ìˆœìœ„: ${strategy.skills.skill2}</span>` : ''}
                            ${strategy.skills.skill3 ? `<span class="hero-badge" style="background: #ffd93d;">3ìˆœìœ„: ${strategy.skills.skill3}</span>` : ''}
                        </div>
                    </div>`;
                }
                
                // ìš´ìš© íŒ
                if (strategy.operationTip) {
                    html += `
                    <div style="background: rgba(152,216,200,0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                        <strong style="color: #6B4966;">ğŸ’¡ ìš´ìš© íŒ</strong>
                        <p style="color: #666; margin-top: 10px; white-space: pre-wrap;">${strategy.operationTip}</p>
                    </div>`;
                }
                
                // ëŒ“ê¸€ ì„¹ì…˜
                html += `
                <div class="comments-section">
                    <strong style="color: #6B4966;">ğŸ’¬ ëŒ“ê¸€ (${strategy.comments ? strategy.comments.length : 0})</strong>
                    <div class="comment-form" style="margin-top: 15px;">
                        <input type="text" class="comment-input" id="commentInput_${strategy.id}" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”...">
                        <button class="comment-btn" onclick="addComment('${strategy.id}')">ë“±ë¡</button>
                    </div>
                    <div class="comment-list" id="comments_${strategy.id}">
                        ${strategy.comments && strategy.comments.length > 0 ? strategy.comments.map(comment => `
                            <div class="comment-item">
                                <div class="comment-header">
                                    <span class="comment-author">${comment.author}</span>
                                    <span>
                                        <span class="comment-date">${new Date(comment.createdAt).toLocaleDateString()}</span>
                                        ${currentUser && (currentUser.uid === comment.authorUid || currentUser.role === 'admin') ? `
                                            <span class="comment-delete" onclick="deleteComment('${strategy.id}', '${comment.id}')">ì‚­ì œ</span>
                                        ` : ''}
                                    </span>
                                </div>
                                <div class="comment-text" style="white-space: pre-wrap;">${comment.text}</div>
                            </div>
                        `).join('') : '<p style="color: #999; font-size: 0.9em; text-align: center; padding: 20px;">ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>'}
                    </div>
                </div>`;
                
                html += `</div>`;
                return html;
            }).join('');
        }

        window.editStrategy = async function(id) {
            const strategy = strategies.find(s => s.id === id);
            if (!strategy) {
                alert('ê³µëµì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ê³µëµ ë“±ë¡ íƒ­ìœ¼ë¡œ ì´ë™
            switchTab('register');
            
            // í¼ì— ë°ì´í„° ì±„ìš°ê¸°
            document.getElementById('strategyName').value = strategy.name;
            
            // ë°©ì–´íŒ€ ì„¤ì • (ë“±ê¸‰ì€ ìœ ì§€í•˜ê³  ì˜ì›…ë§Œ í‘œì‹œ)
             const defenseHeroSelects = [
                { num: 1, hero: strategy.defenseTeam.hero1 },
                { num: 2, hero: strategy.defenseTeam.hero2 },
                { num: 3, hero: strategy.defenseTeam.hero3 }
            ];
            
            defenseHeroSelects.forEach(({ num, hero }) => {
                // ë“±ê¸‰ ë“œë¡­ë‹¤ìš´ ì°¾ê¸° - ì˜ì›… ì„ íƒ ì§ì „ select
                const heroSelect = document.getElementById(`defenseHero${num}`);
                const gradeSelect = heroSelect.previousElementSibling;
                
                // ë“±ê¸‰ ìë™ ì„ íƒ
                let heroGrade = '';
                Object.keys(heroData).forEach(grade => {
                    if (heroData[grade].includes(hero)) {
                        heroGrade = grade;
                    }
                });
                
                if (heroGrade && gradeSelect) {
                    gradeSelect.value = heroGrade;
                    // ë“±ê¸‰ ì„ íƒ ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±°
                    updateDefenseHero(num, heroGrade);
                }
                
                // ì˜ì›… ì„ íƒ
                setTimeout(() => {
                    heroSelect.value = hero;
                }, 50);
            });
            
            // ê³µê²©íŒ€ ì„¤ì •
            const attackHeroData = [
                { num: 1, hero: strategy.attackTeam.hero1 },
                { num: 2, hero: strategy.attackTeam.hero2 },
                { num: 3, hero: strategy.attackTeam.hero3 }
            ];
            
            attackHeroData.forEach(({ num, hero }) => {
                // ë“±ê¸‰ ë“œë¡­ë‹¤ìš´ ì°¾ê¸°
                const heroSelect = document.getElementById(`attackHero${num}`);
                const gradeSelect = heroSelect.previousElementSibling;
                
                // ë“±ê¸‰ ìë™ ì„ íƒ
                let heroGrade = '';
                Object.keys(heroData).forEach(grade => {
                    if (heroData[grade].includes(hero.name)) {
                        heroGrade = grade;
                    }
                });
                
                if (heroGrade && gradeSelect) {
                    gradeSelect.value = heroGrade;
                    // ë“±ê¸‰ ì„ íƒ ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±°
                    updateAttackHero(num, heroGrade);
                }
                
                // ì˜ì›… ì„ íƒ ë° ì œëª© ì—…ë°ì´íŠ¸
                setTimeout(() => {
                    heroSelect.value = hero.name;
                    updateHeroTitle(num, hero.name);
                }, 50);
            });
            
            // ì˜ì›…1 ì¥ë¹„
            document.getElementById('hero1Set').value = strategy.attackTeam.hero1.set || 'ëª¨ë‘';
            document.getElementById('hero1Weapon1').value = strategy.attackTeam.hero1.weapon1 || 'ëª¨ë‘';
            document.getElementById('hero1Weapon2').value = strategy.attackTeam.hero1.weapon2 || 'ëª¨ë‘';
            document.getElementById('hero1Armor1').value = strategy.attackTeam.hero1.armor1 || 'ëª¨ë‘';
            document.getElementById('hero1Armor2').value = strategy.attackTeam.hero1.armor2 || 'ëª¨ë‘';
            document.getElementById('hero1Desc').value = strategy.attackTeam.hero1.description || '';
            
            // ì˜ì›…2 ì¥ë¹„
            document.getElementById('hero2Set').value = strategy.attackTeam.hero2.set || 'ëª¨ë‘';
            document.getElementById('hero2Weapon1').value = strategy.attackTeam.hero2.weapon1 || 'ëª¨ë‘';
            document.getElementById('hero2Weapon2').value = strategy.attackTeam.hero2.weapon2 || 'ëª¨ë‘';
            document.getElementById('hero2Armor1').value = strategy.attackTeam.hero2.armor1 || 'ëª¨ë‘';
            document.getElementById('hero2Armor2').value = strategy.attackTeam.hero2.armor2 || 'ëª¨ë‘';
            document.getElementById('hero2Desc').value = strategy.attackTeam.hero2.description || '';
            
            // ì˜ì›…3 ì¥ë¹„
            document.getElementById('hero3Set').value = strategy.attackTeam.hero3.set || 'ëª¨ë‘';
            document.getElementById('hero3Weapon1').value = strategy.attackTeam.hero3.weapon1 || 'ëª¨ë‘';
            document.getElementById('hero3Weapon2').value = strategy.attackTeam.hero3.weapon2 || 'ëª¨ë‘';
            document.getElementById('hero3Armor1').value = strategy.attackTeam.hero3.armor1 || 'ëª¨ë‘';
            document.getElementById('hero3Armor2').value = strategy.attackTeam.hero3.armor2 || 'ëª¨ë‘';
            document.getElementById('hero3Desc').value = strategy.attackTeam.hero3.description || '';
            
            // ê¸°ì¡´ ì´ë¯¸ì§€ í‘œì‹œ
            hero1Images.length = 0;
            hero2Images.length = 0;
            hero3Images.length = 0;
            
            // ì˜ì›…1 ì´ë¯¸ì§€
            if (strategy.attackTeam.hero1.images && strategy.attackTeam.hero1.images.length > 0) {
                const container = document.getElementById('hero1Images');
                container.innerHTML = '';
                strategy.attackTeam.hero1.images.forEach((imgUrl, idx) => {
                    const div = document.createElement('div');
                    div.className = 'image-preview-item';
                    div.innerHTML = `
                        <img src="${imgUrl}" alt="ê¸°ì¡´ ì´ë¯¸ì§€">
                        <div style="position: absolute; top: 5px; left: 5px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 5px; font-size: 0.8em;">ê¸°ì¡´</div>
                    `;
                    container.appendChild(div);
                });
            }
            
            // ì˜ì›…2 ì´ë¯¸ì§€
            if (strategy.attackTeam.hero2.images && strategy.attackTeam.hero2.images.length > 0) {
                const container = document.getElementById('hero2Images');
                container.innerHTML = '';
                strategy.attackTeam.hero2.images.forEach((imgUrl, idx) => {
                    const div = document.createElement('div');
                    div.className = 'image-preview-item';
                    div.innerHTML = `
                        <img src="${imgUrl}" alt="ê¸°ì¡´ ì´ë¯¸ì§€">
                        <div style="position: absolute; top: 5px; left: 5px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 5px; font-size: 0.8em;">ê¸°ì¡´</div>
                    `;
                    container.appendChild(div);
                });
            }
            
            // ì˜ì›…3 ì´ë¯¸ì§€
            if (strategy.attackTeam.hero3.images && strategy.attackTeam.hero3.images.length > 0) {
                const container = document.getElementById('hero3Images');
                container.innerHTML = '';
                strategy.attackTeam.hero3.images.forEach((imgUrl, idx) => {
                    const div = document.createElement('div');
                    div.className = 'image-preview-item';
                    div.innerHTML = `
                        <img src="${imgUrl}" alt="ê¸°ì¡´ ì´ë¯¸ì§€">
                        <div style="position: absolute; top: 5px; left: 5px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 5px; font-size: 0.8em;">ê¸°ì¡´</div>
                    `;
                    container.appendChild(div);
                });
            }
                        // ì¥ë¹„ ì •ë³´ ì¬ì„¤ì • (ìŠ¤í‚¬ ì˜µì…˜ ì—…ë°ì´íŠ¸ í›„ ê°’ì´ ì´ˆê¸°í™”ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ)
            setTimeout(() => {
                document.getElementById('hero1Set').value = strategy.attackTeam.hero1.set || 'ëª¨ë‘';
                document.getElementById('hero1Weapon1').value = strategy.attackTeam.hero1.weapon1 || 'ëª¨ë‘';
                document.getElementById('hero1Weapon2').value = strategy.attackTeam.hero1.weapon2 || 'ëª¨ë‘';
                document.getElementById('hero1Armor1').value = strategy.attackTeam.hero1.armor1 || 'ëª¨ë‘';
                document.getElementById('hero1Armor2').value = strategy.attackTeam.hero1.armor2 || 'ëª¨ë‘';
                document.getElementById('hero1Desc').value = strategy.attackTeam.hero1.description || '';
                
                document.getElementById('hero2Set').value = strategy.attackTeam.hero2.set || 'ëª¨ë‘';
                document.getElementById('hero2Weapon1').value = strategy.attackTeam.hero2.weapon1 || 'ëª¨ë‘';
                document.getElementById('hero2Weapon2').value = strategy.attackTeam.hero2.weapon2 || 'ëª¨ë‘';
                document.getElementById('hero2Armor1').value = strategy.attackTeam.hero2.armor1 || 'ëª¨ë‘';
                document.getElementById('hero2Armor2').value = strategy.attackTeam.hero2.armor2 || 'ëª¨ë‘';
                document.getElementById('hero2Desc').value = strategy.attackTeam.hero2.description || '';
                
                document.getElementById('hero3Set').value = strategy.attackTeam.hero3.set || 'ëª¨ë‘';
                document.getElementById('hero3Weapon1').value = strategy.attackTeam.hero3.weapon1 || 'ëª¨ë‘';
                document.getElementById('hero3Weapon2').value = strategy.attackTeam.hero3.weapon2 || 'ëª¨ë‘';
                document.getElementById('hero3Armor1').value = strategy.attackTeam.hero3.armor1 || 'ëª¨ë‘';
                document.getElementById('hero3Armor2').value = strategy.attackTeam.hero3.armor2 || 'ëª¨ë‘';
                document.getElementById('hero3Desc').value = strategy.attackTeam.hero3.description || '';
            }, 100);

            // ìŠ¤í‚¬ ìˆœì„œ
            updateSkillOptions();
            if (strategy.skills) {
                document.getElementById('skill1').value = strategy.skills.skill1 || '';
                document.getElementById('skill2').value = strategy.skills.skill2 || '';
                document.getElementById('skill3').value = strategy.skills.skill3 || '';
            }
            
            // ìš´ìš© íŒ
            document.getElementById('operationTip').value = strategy.operationTip || '';
            
            // ìˆ˜ì • ëª¨ë“œ í‘œì‹œ
            const form = document.getElementById('strategyForm');
            form.setAttribute('data-edit-id', id);
            form.setAttribute('data-existing-strategy', JSON.stringify(strategy));
            
            // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.textContent = 'âœï¸ ê³µëµ ìˆ˜ì •í•˜ê¸°';
            
            // ì·¨ì†Œ ë²„íŠ¼ ì¶”ê°€
            if (!document.getElementById('cancelEditBtn')) {
                const cancelBtn = document.createElement('button');
                cancelBtn.id = 'cancelEditBtn';
                cancelBtn.type = 'button';
                cancelBtn.className = 'btn';
                cancelBtn.style.background = '#999';
                cancelBtn.textContent = 'ì·¨ì†Œ';
                cancelBtn.onclick = function() {
                    form.reset();
                    form.removeAttribute('data-edit-id');
                    form.removeAttribute('data-existing-strategy');
                    submitBtn.textContent = 'âœ… ê³µëµ ë“±ë¡í•˜ê¸°';
                    cancelBtn.remove();
                    hero1Images.length = 0;
                    hero2Images.length = 0;
                    hero3Images.length = 0;
                    renderImages(1);
                    renderImages(2);
                    renderImages(3);
                };
                submitBtn.parentNode.insertBefore(cancelBtn, submitBtn);
            }
            
            alert('ìˆ˜ì • ëª¨ë“œë¡œ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nâ€¢ ê¸°ì¡´ ì´ë¯¸ì§€ëŠ” "ê¸°ì¡´" íƒœê·¸ë¡œ í‘œì‹œë©ë‹ˆë‹¤.\nâ€¢ ìƒˆ ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•˜ë©´ ê¸°ì¡´ ì´ë¯¸ì§€ë¥¼ ëŒ€ì²´í•©ë‹ˆë‹¤.\nâ€¢ ë³€ê²½ í›„ "ê³µëµ ìˆ˜ì •í•˜ê¸°" ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.');
        };

        window.deleteStrategy = async function(id) {
            if (!confirm('ì´ ê³µëµì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            try {
                await deleteDoc(doc(db, 'attack_strategies', id));
                alert('ê³µëµì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                loadStrategies();
            } catch (error) {
                console.error('ì‚­ì œ ì˜¤ë¥˜:', error);
                alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        };

window.searchStrategies = function() {
            const searchText = document.getElementById('searchInput').value.toLowerCase().trim();
            
            if (!searchText) {
                // ê²€ìƒ‰ì–´ ì—†ìœ¼ë©´ ì „ì²´ í‘œì‹œ
                renderStrategies();
                return;
            }
            
            // ê²€ìƒ‰ í•„í„°ë§
            const filteredStrategies = strategies.filter(strategy => {
                // ê³µëµ ì´ë¦„
                if (strategy.name.toLowerCase().includes(searchText)) return true;
                
                // ë°©ì–´íŒ€ ì˜ì›…
                if (strategy.defenseTeam.hero1.toLowerCase().includes(searchText)) return true;
                if (strategy.defenseTeam.hero2.toLowerCase().includes(searchText)) return true;
                if (strategy.defenseTeam.hero3.toLowerCase().includes(searchText)) return true;
                
                // ê³µê²©íŒ€ ì˜ì›…
                if (strategy.attackTeam.hero1.name.toLowerCase().includes(searchText)) return true;
                if (strategy.attackTeam.hero2.name.toLowerCase().includes(searchText)) return true;
                if (strategy.attackTeam.hero3.name.toLowerCase().includes(searchText)) return true;
                
                // ì¥ë¹„ ì„¤ëª…
                if (strategy.attackTeam.hero1.description && strategy.attackTeam.hero1.description.toLowerCase().includes(searchText)) return true;
                if (strategy.attackTeam.hero2.description && strategy.attackTeam.hero2.description.toLowerCase().includes(searchText)) return true;
                if (strategy.attackTeam.hero3.description && strategy.attackTeam.hero3.description.toLowerCase().includes(searchText)) return true;
                
                // ìš´ìš© íŒ
                if (strategy.operationTip && strategy.operationTip.toLowerCase().includes(searchText)) return true;
                
                return false;
            });
            
            // ê²€ìƒ‰ ê²°ê³¼ë¡œ ë Œë”ë§
            const originalStrategies = strategies;
            strategies = filteredStrategies;
            renderStrategies();
            strategies = originalStrategies;
            
            // ê²€ìƒ‰ ê²°ê³¼ ì•ˆë‚´
            if (filteredStrategies.length === 0) {
                document.getElementById('strategyList').innerHTML = `
                    <div class="strategy-card">
                        <p style="text-align: center; color: #999;">
                            "${searchText}" ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
                        </p>
                    </div>
                `;
            }
        };
        window.showImageModal = function(imageSrc) {
            document.getElementById('imageModal').classList.add('active');
            document.getElementById('modalImage').src = imageSrc;
        };

        window.closeImageModal = function() {
            document.getElementById('imageModal').classList.remove('active');
        };

        // ëŒ“ê¸€ ì¶”ê°€ í•¨ìˆ˜
        window.addComment = async function(strategyId) {
            const input = document.getElementById(`commentInput_${strategyId}`);
            const text = input.value.trim();
            
            if (!text) {
                alert('ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                const comment = {
                    id: Date.now().toString(),
                    text: text,
                    author: currentUser.nickname,
                    authorUid: currentUser.uid,
                    createdAt: new Date().toISOString()
                };
                
                const strategy = strategies.find(s => s.id === strategyId);
                if (!strategy.comments) strategy.comments = [];
                strategy.comments.push(comment);
                
                await updateDoc(doc(db, 'attack_strategies', strategyId), {
                    comments: strategy.comments
                });
                
                input.value = '';
                loadStrategies();
            } catch (error) {
                console.error('ëŒ“ê¸€ ì¶”ê°€ ì˜¤ë¥˜:', error);
                alert('ëŒ“ê¸€ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        };

        // ëŒ“ê¸€ ì‚­ì œ í•¨ìˆ˜
        window.deleteComment = async function(strategyId, commentId) {
            if (!confirm('ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            try {
                const strategy = strategies.find(s => s.id === strategyId);
                strategy.comments = strategy.comments.filter(c => c.id !== commentId);
                
                await updateDoc(doc(db, 'attack_strategies', strategyId), {
                    comments: strategy.comments
                });
                
                loadStrategies();
            } catch (error) {
                console.error('ëŒ“ê¸€ ì‚­ì œ ì˜¤ë¥˜:', error);
                alert('ëŒ“ê¸€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        };

    </script>

<!-- ì´ë¯¸ì§€ ëª¨ë‹¬ -->
        <div id="imageModal" class="image-modal" onclick="closeImageModal()">
            <span class="image-modal-close">&times;</span>
            <img id="modalImage" src="" alt="í™•ëŒ€ ì´ë¯¸ì§€">
        </div>
</body>
</html>