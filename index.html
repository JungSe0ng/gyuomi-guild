<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê·€ìš”ë¯¸ ê¸¸ë“œ ì„¸ë¸ë‚˜ì´ì¸  ê³µëµì§‘ âœ¨</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<!-- ë¡œê·¸ì¸/íšŒì›ê°€ì… ì˜¤ë²„ë ˆì´ -->
<div id="authOverlay" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(107, 73, 102, 0.97), rgba(139, 90, 134, 0.97)); z-index: 9999; display: flex; align-items: center; justify-content: center; padding: 20px;">
    <div style="background: white; border-radius: 25px; padding: 40px; max-width: 450px; width: 100%; box-shadow: 0 20px 60px rgba(0,0,0,0.4); animation: fadeInUp 0.5s ease;">
        <!-- ë¡œê³  -->
        <div style="text-align: center; margin-bottom: 30px;">
            <div style="width: 100px; height: 100px; margin: 0 auto 15px; background: linear-gradient(135deg, #B08AB0, #8B5A86); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 24px rgba(176,138,176,0.4);">
                <span style="font-size: 3em;">âš”ï¸</span>
            </div>
            <h2 style="color: #B08AB0; margin: 0; font-size: 1.8em;">ê·€ìš”ë¯¸ ê¸¸ë“œ ê³µëµì§‘</h2>
            <p style="color: #999; margin-top: 8px; font-size: 0.9em;">ê¸¸ë“œì› ì „ìš© ê³µê°„ì…ë‹ˆë‹¤</p>
        </div>
        
        <!-- íƒ­ ë²„íŠ¼ -->
        <div style="display: flex; gap: 10px; margin-bottom: 25px; background: #f0f0f0; padding: 5px; border-radius: 12px;">
            <button id="loginTabBtn" onclick="switchAuthTab('login')" style="flex: 1; padding: 12px; background: linear-gradient(135deg, #B08AB0, #8B5A86); color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: all 0.3s;">ë¡œê·¸ì¸</button>
            <button id="signupTabBtn" onclick="switchAuthTab('signup')" style="flex: 1; padding: 12px; background: transparent; color: #666; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: all 0.3s;">íšŒì›ê°€ì…</button>
        </div>
        
        <!-- ë¡œê·¸ì¸ í¼ -->
        <div id="loginForm">
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold;">ì´ë©”ì¼</label>
                <input type="email" id="loginEmail" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”" style="width: 100%; padding: 14px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em; transition: border 0.3s;" onfocus="this.style.borderColor='#B08AB0'" onblur="this.style.borderColor='#e0e0e0'">
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold;">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" style="width: 100%; padding: 14px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em; transition: border 0.3s;" onfocus="this.style.borderColor='#B08AB0'" onblur="this.style.borderColor='#e0e0e0'">
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; color: #555;">
                    <input type="checkbox" id="rememberMe" style="width: 18px; height: 18px; cursor: pointer;">
                    <span>ìë™ ë¡œê·¸ì¸</span>
                </label>
            </div>
            <button onclick="handleLogin()" style="width: 100%; padding: 16px; background: linear-gradient(135deg, #B08AB0, #8B5A86); color: white; border: none; border-radius: 12px; font-size: 1.1em; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(176,138,176,0.4); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(176,138,176,0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(176,138,176,0.4)'">
                ë¡œê·¸ì¸ í•˜ê¸°
            </button>
        </div>
        
        <!-- íšŒì›ê°€ì… í¼ -->
        <div id="signupForm" style="display: none;">
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold;">ì´ë©”ì¼</label>
                <input type="email" id="signupEmail" placeholder="ì´ë©”ì¼" style="width: 100%; padding: 14px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em; transition: border 0.3s;" onfocus="this.style.borderColor='#98D8C8'" onblur="this.style.borderColor='#e0e0e0'">
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold;">ë‹‰ë„¤ì„</label>
                <input type="text" id="signupNickname" placeholder="ë‹‰ë„¤ì„ (2-10ì)" style="width: 100%; padding: 14px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em; transition: border 0.3s;" onfocus="this.style.borderColor='#98D8C8'" onblur="this.style.borderColor='#e0e0e0'">
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold;">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="signupPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ (6ì ì´ìƒ)" style="width: 100%; padding: 14px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em; transition: border 0.3s;" onfocus="this.style.borderColor='#98D8C8'" onblur="this.style.borderColor='#e0e0e0'">
            </div>
            <div style="margin-bottom: 25px;">
                <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold;">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                <input type="password" id="signupPasswordConfirm" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”" style="width: 100%; padding: 14px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em; transition: border 0.3s;" onfocus="this.style.borderColor='#98D8C8'" onblur="this.style.borderColor='#e0e0e0'">
            </div>
            <button onclick="handleRegister()" style="width: 100%; padding: 16px; background: linear-gradient(135deg, #98D8C8, #6FC3A8); color: white; border: none; border-radius: 12px; font-size: 1.1em; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(152,216,200,0.4); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(152,216,200,0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(152,216,200,0.4)'">
                íšŒì›ê°€ì… í•˜ê¸°
            </button>
        </div>
    </div>
</div>

<style>
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
</style>

    <div class="container">
        <header>
            <div class="logo-container" style="margin-bottom: 20px;">
                <div style="width: 120px; height: 120px; margin: 0 auto; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
                    <span style="font-size: 4em;">âš”ï¸</span>
                </div>
            </div>
            <h1>ğŸŒ¸ ê·€ìš”ë¯¸ ê¸¸ë“œ ğŸŒ¸</h1>
            <p style="font-size: 1.2em; opacity: 0.95; margin-top: 10px;">ì„¸ë¸ë‚˜ì´ì¸  ê³µëµ ê³µìœ  í”Œë«í¼</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('main')">ğŸ  ë©”ì¸</button>
            <button class="tab-btn" onclick="switchTab('attack')">âš”ï¸ ê³µê²© ê³µëµ</button>
            <button class="tab-btn" onclick="switchTab('defense')">ğŸ›¡ï¸ ë°©ì–´ ê³µëµ</button>
        </div>

        <!-- ë©”ì¸ íƒ­ -->
        <div id="main-tab" class="tab-content active">
            <div class="card">
                <h2 style="text-align: center; margin-bottom: 30px;">ğŸŒ¸ í™˜ì˜í•©ë‹ˆë‹¤! ğŸŒ¸</h2>
                
                <div style="background: linear-gradient(135deg, rgba(176,138,176,0.1), rgba(152,216,200,0.1)); padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                    <h3 style="margin-top: 0; color: #B08AB0;">ğŸ“‹ ê¸¸ë“œ ì†Œê°œ</h3>
                    <p style="line-height: 1.8; color: #555;">
                        ê·€ìš”ë¯¸ ê¸¸ë“œëŠ” ì„¸ë¸ë‚˜ì´ì¸ ë¥¼ í•¨ê»˜ ì¦ê¸°ëŠ” ê¸¸ë“œì…ë‹ˆë‹¤!<br>
                        ê³µê²© ê³µëµê³¼ ë°©ì–´ íŒ€ êµ¬ì„±ì„ ê³µìœ í•˜ë©° í•¨ê»˜ ì„±ì¥í•´ìš”! ğŸ’ª
                    </p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, rgba(176,138,176,0.15), rgba(139,90,134,0.15)); padding: 20px; border-radius: 12px; border: 2px solid rgba(176,138,176,0.3);">
                        <div style="font-size: 2em; margin-bottom: 10px;">âš”ï¸</div>
                        <h4 style="margin: 0 0 10px 0; color: #B08AB0;">ê³µê²© ê³µëµ</h4>
                        <p style="margin: 0; font-size: 0.9em; color: #666;">ìƒëŒ€ ë°©ì–´íŒ€ì„ ìƒëŒ€í•  ê³µëµì„ ë“±ë¡í•˜ê³  í™•ì¸í•˜ì„¸ìš”!</p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, rgba(152,216,200,0.15), rgba(111,195,168,0.15)); padding: 20px; border-radius: 12px; border: 2px solid rgba(152,216,200,0.3);">
                        <div style="font-size: 2em; margin-bottom: 10px;">ğŸ›¡ï¸</div>
                        <h4 style="margin: 0 0 10px 0; color: #98D8C8;">ë°©ì–´ ê³µëµ</h4>
                        <p style="margin: 0; font-size: 0.9em; color: #666;">ê°•ë ¥í•œ ë°©ì–´ íŒ€ êµ¬ì„±ì„ ê³µìœ í•˜ê³  ë°°ì›Œë³´ì„¸ìš”!</p>
                    </div>
                </div>

                <div style="background: rgba(255,255,255,0.5); padding: 20px; border-radius: 12px; border: 2px dashed rgba(176,138,176,0.3); margin-bottom: 25px;">
                    <h4 style="margin-top: 0; color: #B08AB0;">ğŸ’¡ ì´ìš© íŒ</h4>
                    <ul style="line-height: 1.8; color: #555;">
                        <li>ê° íƒ­ì—ì„œ ê³µëµì„ í™•ì¸í•˜ê³  ë°°ì›Œë³´ì„¸ìš”</li>
                        <li>ê²€ìƒ‰ ê¸°ëŠ¥ìœ¼ë¡œ ì›í•˜ëŠ” ì˜ì›… ê³µëµì„ ë¹ ë¥´ê²Œ ì°¾ì„ ìˆ˜ ìˆì–´ìš”</li>
                        <li>ê´€ë¦¬ìëŠ” ìƒˆë¡œìš´ ê³µëµì„ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                    </ul>
                </div>

                <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <h3 style="margin-top: 0; color: #B08AB0; display: flex; align-items: center; gap: 10px;">
                        <span>ğŸ‘¥</span>
                        <span>ê¸¸ë“œì› ëª©ë¡</span>
                    </h3>
                    <div id="guildMembersList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                        <!-- ê¸¸ë“œì› ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ê³µê²© ê³µëµ íƒ­ -->
        <div id="attack-tab" class="tab-content">
            <div class="sub-tabs" style="display: flex; gap: 15px; margin-bottom: 20px; background: rgba(255,255,255,0.3); padding: 10px; border-radius: 15px;">
                <button class="sub-tab-btn attack-tab active" data-subtab="register" data-admin-only>ê³µëµ ë“±ë¡</button>
                <button class="sub-tab-btn attack-tab" data-subtab="list">ê³µëµ ëª©ë¡</button>
            </div>

            <!-- ê³µëµ ë“±ë¡ -->
            <div id="register-content" class="sub-content active" data-admin-only>
                <div class="card">
                    <h2>âœï¸ ê³µê²© ê³µëµ ë“±ë¡</h2>
                    
                    <form id="guideForm" onsubmit="saveGuide(event)">
                        <div class="form-group">
                            <label>ê³µëµ ì œëª©</label>
                            <input type="text" id="guideTitle" placeholder="ì˜ˆ: ì¹´êµ¬ë¼ í”¼ì•„ í”Œë¡œ ìˆ™ì£¼ ê³µëµ" required>
                        </div>

                        <div class="form-group">
                            <label>ğŸ›¡ï¸ ìƒëŒ€ ë°©ì–´íŒ€ (3ëª…)</label>
                            <div class="hero-grid">
                                <div>
                                    <select onchange="updateEnemyHero1Options(this.value)" style="margin-bottom: 8px;">
                                        <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                        <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                        <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                        <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                        <option value="í¬ê·€">í¬ê·€</option>
                                    </select>
                                    <select id="enemyHero1" required disabled>
                                        <option value="">ì˜ì›… ì„ íƒ</option>
                                    </select>
                                </div>
                                <div>
                                    <select onchange="updateEnemyHero2Options(this.value)" style="margin-bottom: 8px;">
                                        <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                        <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                        <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                        <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                        <option value="í¬ê·€">í¬ê·€</option>
                                    </select>
                                    <select id="enemyHero2" required disabled>
                                        <option value="">ì˜ì›… ì„ íƒ</option>
                                    </select>
                                </div>
                                <div>
                                    <select onchange="updateEnemyHero3Options(this.value)" style="margin-bottom: 8px;">
                                        <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                        <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                        <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                        <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                        <option value="í¬ê·€">í¬ê·€</option>
                                    </select>
                                    <select id="enemyHero3" required disabled>
                                        <option value="">ì˜ì›… ì„ íƒ</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary">ê³µëµ ì €ì¥í•˜ê¸°</button>
                    </form>
                </div>
            </div>

            <!-- ê³µëµ ëª©ë¡ -->
            <div id="list-content" class="sub-content">
                <div class="card">
                    <h2>ğŸ“š ë“±ë¡ëœ ê³µëµ</h2>
                    
                    <div style="margin-bottom: 20px;">
                        <input type="text" id="searchInput" placeholder="ğŸ” ì˜ì›… ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰..." style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em;" oninput="searchGuides()">
                    </div>
                    
                    <div id="guideList"></div>
                </div>
            </div>
        </div>

        <!-- ë°©ì–´ ê³µëµ íƒ­ -->
        <div id="defense-tab" class="tab-content">
            <div class="sub-tabs" style="display: flex; gap: 15px; margin-bottom: 20px; background: rgba(255,255,255,0.3); padding: 10px; border-radius: 15px;">
                <button class="sub-tab-btn defense-tab active" data-subtab="def-register" data-admin-only>ë°©ì–´íŒ€ ë“±ë¡</button>
                <button class="sub-tab-btn defense-tab" data-subtab="def-list">ë°©ì–´íŒ€ ëª©ë¡</button>
            </div>

            <!-- ë°©ì–´íŒ€ ë“±ë¡ -->
            <div id="def-register-content" class="sub-content active" data-admin-only>
                <div class="card">
                    <h2>ğŸ›¡ï¸ ë°©ì–´íŒ€ ë“±ë¡</h2>
                    
                    <form id="defenseForm" onsubmit="saveDefenseTeam(event)">
                        <div class="form-group">
                            <label>íŒ€ ì´ë¦„</label>
                            <input type="text" id="defenseName" placeholder="ì˜ˆ: ë©”ì¸ ë°©ì–´íŒ€" required>
                        </div>

                        <div class="form-group">
                            <label>ë°©ì–´ ì˜ì›… (3ëª…)</label>
                            <div class="hero-grid">
                                <div>
                                    <select onchange="updateDefTeamHero1Options(this.value)" style="margin-bottom: 8px;">
                                        <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                        <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                        <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                        <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                        <option value="í¬ê·€">í¬ê·€</option>
                                    </select>
                                    <select id="defTeamHero1" required onchange="updateDefenseEquipment()" disabled>
                                        <option value="">ì˜ì›… ì„ íƒ</option>
                                    </select>
                                </div>
                                <div>
                                    <select onchange="updateDefTeamHero2Options(this.value)" style="margin-bottom: 8px;">
                                        <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                        <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                        <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                        <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                        <option value="í¬ê·€">í¬ê·€</option>
                                    </select>
                                    <select id="defTeamHero2" required onchange="updateDefenseEquipment()" disabled>
                                        <option value="">ì˜ì›… ì„ íƒ</option>
                                    </select>
                                </div>
                                <div>
                                    <select onchange="updateDefTeamHero3Options(this.value)" style="margin-bottom: 8px;">
                                        <option value="">ë“±ê¸‰ ì„ íƒ</option>
                                        <option value="êµ¬ì„¸ë‚˜">êµ¬ì„¸ë‚˜</option>
                                        <option value="ì°ìŠ¤">ì°ìŠ¤</option>
                                        <option value="ì§­ìŠ¤">ì§­ìŠ¤</option>
                                        <option value="í¬ê·€">í¬ê·€</option>
                                    </select>
                                    <select id="defTeamHero3" required onchange="updateDefenseEquipment()" disabled>
                                        <option value="">ì˜ì›… ì„ íƒ</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div id="defenseEquipmentContainer"></div>

                        <div class="form-group">
                            <label>ë°°ì¹˜ ì „ëµ ë° ìš´ìš© íŒ</label>
                            <textarea id="defenseTip" rows="3" placeholder="ì „ì²´ì ì¸ ìš´ìš©ë²•, í¬ì§€ì…˜ ë“±"></textarea>
                        </div>

                        <button type="submit" class="btn btn-success">ë°©ì–´íŒ€ ì €ì¥í•˜ê¸°</button>
                    </form>
                </div>
            </div>

            <!-- ë°©ì–´íŒ€ ëª©ë¡ -->
            <div id="def-list-content" class="sub-content">
                <div class="card">
                    <h2>ğŸ“‹ ë“±ë¡ëœ ë°©ì–´íŒ€</h2>
                    <div id="defenseList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, query, orderBy, setDoc, getDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyAIuUCCt5RfN5Jv9THi3-OAn1F4xJ7TH4U",
            authDomain: "gyuomi-guild.firebaseapp.com",
            projectId: "gyuomi-guild",
            storageBucket: "gyuomi-guild.firebasestorage.app",
            messagingSenderId: "43293575259",
            appId: "1:43293575259:web:2ac8bd0dfecda6a2be177e",
            measurementId: "G-PT8DNQV1DY"
        };

        // Firebase ì´ˆê¸°í™”
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ì „ì—­ìœ¼ë¡œ export
        window.auth = auth;
        window.db = db;
        window.firebaseAuth = { createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut };
        window.firestore = { collection, addDoc, getDocs, doc, updateDoc, deleteDoc, query, orderBy, setDoc, getDoc };
    </script>
    
    <script src="auth.js"></script>
    <script src="script.js"></script>
</body>
</html>